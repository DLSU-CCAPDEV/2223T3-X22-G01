<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" type="text/css" href="../css/index.css">
        <title>Salamin | Home</title>

        <!-- Unicons -->
        <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css" />

    </head>
    <body>
        

        <!-- Home -->
        <div class="home">
            <div class="form_content">
                <i class="uil uil-times form_close"></i>

                <!-- Login Form -->
                <div class="login_form">
                    <form action="#">
                        <h2>Login</h2>

                        <div class="input_box">
                            <input type="email" placeholder="Enter your email" required />
                            <i class="uil uil-envelope-alt email"></i>
                        </div>

                        <div class="input_box">
                            <input type="password" placeholder="Enter your password" required />
                            <i class="uil uil-lock password"></i>
                            <i class="uil uil-eye-slash pw_hide"></i>
                        </div>


                        <div class="options">
                            <span class="checkbox">
                                <input type="checkbox" id="check">
                                <label for="check">Remember me</label>
                            </span>
                            <a href="#" class="forgot_pw">Forgot password?</a>
                        </div>

                        <button class="button">
                            <a href="/" style="color: white; text-decoration: none;">Login Now</a>
                        </button>

                        <div class="login_sign-up">Don't have an account yet? <a href="#" id="sign-up"> Sign-up</a></div>
                    </form>
                </div>

                <!-- Sign-up Form -->
                <div class="sign-up_form">
                    <form action="#">
                        <h2>Sign-up</h2>

                        <div class="input_box">
                            <input type="email" placeholder="Enter your email" required />
                            <i class="uil uil-envelope-alt email"></i>
                        </div>

                        <div class="input_box">
                            <input type="password" placeholder="Create your password" required />
                            <i class="uil uil-lock password"></i>
                            <i class="uil uil-eye-slash pw_hide"></i>
                        </div>

                        <div class="input_box">
                            <input type="password" placeholder="Confirm your password" required />
                            <i class="uil uil-lock password"></i>
                            <i class="uil uil-eye-slash pw_hide"></i>
                        </div>

                        <button class="button">
                            <a href="/timeline" style="color: white; text-decoration: none;">Sign-Up Now</a>
                        </button>

                        <div class="login_sign-up">Already have an account?<a href="#" id="sign-up"> Log-in</a></div>
                    </form>
                </div>
            </div>

            <div class="page">
                <!-- Header -->
                <header class="header">
                    
                        <div class="header-logo"></div>
    
                        <div class="search-bar">
                            <ion-icon name="search-outline"></ion-icon>
                            <form class="searchForm">
                                <input type="text" placeholder="Search" id="search" name="filter">
                            </form>
                        </div>
            
                        <nav class="dropdown-container">
                            <ion-icon class="dropdown-button" name="filter-outline"></ion-icon>
            
                            <div class = "dropdown-items">
                                <button onclick="window.location.href = '/index?sortBy=recent';">Recent</button>
                                <button onclick="window.location.href = '/index?sortBy=old';">Old</button>
                                <button onclick="window.location.href = '/index?sortBy=popular';">Popular</button>
                                <button onclick="window.location.href = '/index?sortBy=unpopular';">Unpopuar</button>
                            </div>
                        </nav>
                    
                        
                        <!-- Login Button -->
                        <button class="nav_btn" id="form-open">Login</button>
                    
                </header>
    
                <div class="box">
                    <input type="text" placeholder="Title" class="post-title" id="post-title">
                    <span class="textarea" role="textbox" id="post-box" contenteditable></span>
                    
                    <button id="form-open-post" >Post</button>
                </div>
        
                <div class="page-content" id="page-content"> <!-- timeline -->
                    
                <div class="post"> <!-- posts proper -->
                <div class="post-content glasshover">
                    
                    <div class="vote-container vote-width">
                        <ion-icon name="caret-up-outline" ></ion-icon>
                        <div >{{votes}}</div>
                        <ion-icon name="caret-down-outline" ></ion-icon>
                    </div>

                    <a href="/:username/:postID">
                        <div class="post-text">
                            
                            <h1>{{title}}</h1>
                            <h2>{{username}} | {{date}} | {{numComments}} replies</h2>
                            
                        </div>
                    </a>

                </div>
                
                
                <div style="background-image: url(/images/{{icon}})" class="post-pfp"></div>

            </div>  
                </div>
            </div>
        </div>

        
   
        
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="..\javascript\unregistered.js"></script>
    <!-- Load in posts from data.js -->
<script src = "../javascript/data.js"></script>
<script>

const params = new Proxy(new URLSearchParams(window.location.search), {
        get: (searchParams, prop) => searchParams.get(prop),
    });

	var post2;
	if (!(params.filter === null)){
		post2 = post.filter(function(item)
		{
			if (item.title.toLowerCase().includes(params.filter)) return true;
			if (item.description.toLowerCase().includes(params.filter)) return true;
	
		});
	} else {
		post2 = post; 
	}
		
	
	switch(params.sortBy) {
		case 'popular':
			post2.sort((a, b) => {
				return b.votes - a.votes;
			});
			break;
		case 'recent':
			post2.sort((a, b) => {
				return b.date - a.date;
			});
			break;
		case 'unpopular':
			post2.sort((a, b) => {
				return a.votes - b.votes;
			});
			break;
		case 'old':
			post2.sort((a, b) => {
				return a.date - b.date;
			});
			break;
		
		default:
			//sort by id
			post2.sort((a, b) => {
				return a.id - b.id;
			});
	}

	var container = document.getElementById('page-content');
	function addPost(p) {
		var u = user.find(t => t.userID == p.userID);


		container.insertAdjacentHTML('beforeend',html);
	}
	
	for (let p of post2) {
		addPost(p);
	}
    </script>
    </body>
</html>
